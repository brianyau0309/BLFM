#!/bin/sh

div='|'

printNotification() {
  [ -f /tmp/.dunsttoggle ] && echo ğŸ”• || echo ğŸ””
}

printStorage() {
  df -h ~ | grep -v 'Filesystem' | awk '{ print "ïŸ‰ " $4 }'
}

printDate() {
  date '+ğŸ—“ %a %d-%b %H:%M:%S'
}

printAudio() {
  soundnum=$(echo $(amixer sget Master | grep 'Left:' | awk -F"[][]" '{ print $2 }') | sed 's/%//')
  amixer sget Master | grep off >/dev/null &&
    echo ğŸ”‡ ||
    ( ([ $soundnum -gt 80 ] && echo ğŸ”Š) ||
      ([ $soundnum -gt 20 ] && echo ğŸ”‰) ||
      echo ğŸ”ˆ )
}

printMusic() {
  pgrep mocp >/dev/null && [ ! "$(mocp -Q %file 2>/dev/null)" = ""  ] &&
    ((mocp -i | grep PLAY >/dev/null) && echo "ï€" || echo "ïŠ‹") &&
    mocp -Q %song
}

statusBar() {
  printMusic
  [ -z $(wkon anchor)  ] || echo "ğŸ“ $(wkon anchor | rev | cut -d'/' -f1 | rev)"
  printStorage
  echo 'ï–€ 90%'
  printDate
  printAudio
  printNotification
  echo ï‡«
}

# Reset while enter xorg
[ -f /tmp/.dunsttoggle ] && rm /tmp/.dunsttoggle

while :; do
  xsetroot -name " $( statusBar | tr '\n' ' ')" #Change newline to space
  sleep 10
done
